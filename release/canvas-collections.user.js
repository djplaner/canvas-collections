// ==UserScript==
// @name         canvas-collections
// @namespace    https://djon.es/
// @version      0.8.0
// @description  Modify Canvas LMS modules to support collections of modules and their representation
// @author       David Jones
// @match        https://*/courses/*
// @grant        none
// @source       https://github.com/djplaner/canvas-collections.git
// @license      ISC
// @homepage     https://github.com/djplaner/canvas-collections/tree/main#canvas-collections
// @require      https://unpkg.com/circular-progress-bar
// ==/UserScript==

class cc_ConfigurationModel{constructor(controller){DEBUG&&console.log("-------------- cc_ConfigurationModel.constructor()"),this.controller=controller,this.configShowing=!1,this.CONFIG_SHOW_ICONS={true:"icon-mini-arrow-down",false:"icon-mini-arrow-right"}}isOn(){return DEBUG&&console.log(`-------------- cc_ConfigurationModel.isOn() - ${this.controller.parentController.ccOn}`),this.controller.parentController.ccOn}turnOn(){DEBUG&&console.log("-------------- cc_ConfigurationModel.turnOn()"),this.controller.parentController.ccOn=!0,this.controller.parentController.cc_configuration.STATUS}turnOff(){DEBUG&&console.log("-------------- cc_ConfigurationModel.turnOff()"),this.controller.parentController.ccOn=!1,this.controller.parentController.cc_configuration.STATUS}getConfigShowing(){return this.configShowing}getModuleDetails(){DEBUG&&console.log("-------------- cc_ConfigurationModel.getModuleDetails()");return this.controller.parentController.moduleDetails.reduce(((accumulator,module)=>(accumulator[module.id]=module,accumulator)),{})}setModuleConfigClass(moduleId,newClass){DEBUG&&console.log(`-------------- cc_ConfigurationModel.setModuleConfigClass() - ${moduleId} ${newClass}`);const module=this.controller.parentController.moduleDetails.find((module=>module.id===moduleId));module.configClass="icon-mini-arrow-down"===newClass?"icon-mini-arrow-right":"icon-mini-arrow-down"}getConfigShowClass(){return this.CONFIG_SHOW_ICONS[this.configShowing]}getOtherConfigShowClass(className){return this.CONFIG_SHOW_ICONS[!1]===className?this.CONFIG_SHOW_ICONS[!0]:this.CONFIG_SHOW_ICONS[!1]}setConfigShowClass(newClass){this.CONFIG_SHOW_ICONS[!1]===newClass?this.configShowing=!1:this.configShowing=!0,DEBUG&&console.log(`-------------- cc_ConfigurationModel.setConfigShowClass() - ${newClass} change to - ${this.configShowing}`)}getExistingCollectionNames(){return DEBUG&&console.log("-------------- cc_ConfigurationModel.getExistingCollectionNames()"),Object.keys(this.controller.parentController.cc_configuration.COLLECTIONS)}getModuleCount(collectionName){DEBUG&&console.log("-------------- cc_ConfigurationModel.getModuleCount()");const modules=this.controller.parentController.cc_configuration.MODULES;return Object.keys(modules).filter((module=>modules[module].collection===collectionName)).length}getModuleConfiguration(moduleName){return this.controller.parentController.cc_configuration.MODULES[moduleName]}getDefaultCollection(){return DEBUG&&console.log("-------------- cc_ConfigurationModel.getDefaultCollection()"),this.controller.parentController.cc_configuration.DEFAULT_ACTIVE_COLLECTION}getCollectionRepresentation(collectionName){return DEBUG&&console.log("-------------- cc_ConfigurationModel.getCollectionRepresentation()"),console.log(`representation is ${this.controller.parentController.cc_configuration.COLLECTIONS[collectionName].representation}`),this.controller.parentController.cc_configuration.COLLECTIONS[collectionName].representation}getCollections(){return DEBUG&&console.log("-------------- cc_ConfigurationModel.getCollections()"),Object.keys(this.controller.parentController.cc_configuration.COLLECTIONS)}}class cc_View{constructor(model,controller){this.model=model,this.controller=controller}}const CC_VERSION="0.7.3";class cc_ConfigurationView extends cc_View{constructor(model,controller){super(model,controller)}display(){DEBUG&&console.log("-------------- cc_ConfigurationView.display()"),this.addCcBundle(),this.model.getConfigShowing()?this.showConfig():this.removeConfig();const configShowClass=this.model.getConfigShowClass(),configShowSwitch=document.getElementById("configShowSwitch");configShowSwitch&&(configShowSwitch.className=configShowClass),document.querySelectorAll("div.cc-module-config").forEach((div=>{div.remove()})),this.addModuleConfiguration()}addModuleConfiguration(){const moduleDetails=this.model.getModuleDetails(),moduleHeaders=document.getElementsByClassName("ig-header");for(let i=0;i<moduleHeaders.length;i++){const moduleHeader=moduleHeaders[i],id=moduleHeader.id,moduleDetail=moduleDetails[id];if(void 0===moduleDetail)continue;let showConfigHtml="";"configClass"in moduleDetail?"icon-mini-arrow-down"===moduleDetail.configClass&&(showConfigHtml=this.showModuleConfig(moduleDetail)):moduleDetail.configClass="icon-mini-arrow-right";const moduleConfigHtml=`\n\t\t<div class="cc-module-config border border-trbl" id="cc-module-config-${id}">\n      \t\t<span>\n\t\t\t  <i id="cc-module-config-${id}-switch" class="icon-mini-arrow-right"></i>\n\t\t\t  Canvas Collections Configuration</span>\n\t\t\t  ${showConfigHtml}\n  \t\t</div>`;moduleHeader.insertAdjacentHTML("afterend",moduleConfigHtml);const moduleConfigSwitch=document.getElementById(`cc-module-config-${id}-switch`);moduleConfigSwitch&&(moduleConfigSwitch.onclick=event=>this.controller.toggleModuleConfigSwitch(event),moduleConfigSwitch.className=moduleDetail.configClass)}}showModuleConfig(moduleDetail){DEBUG&&console.log("-------------- cc_ConfigurationView.showModuleConfig()"),console.log(moduleDetail);const moduleConfig=this.model.getModuleConfiguration(moduleDetail.name);console.log("---- configuration"),console.log(moduleConfig);const collections=this.model.getCollections();let collectionsOptions="";for(let i=0;i<collections.length;i++){let selected="";const collection=collections[i];collection===moduleConfig.collection&&(selected="selected"),collectionsOptions+=`<option value="${collection}" ${selected}>${collection}</option>`}return`\n\t\t<style>\n\t\t   .cc-collection-representation label {\n\t\t\t   width: 5rem;\n\t\t\t   font-size: 0.8rem;\n\t\t   }\n\t\t   .cc-collection-representation input {\n\t\t\t   font-size: 0.8rem;\n\t\t   }\n\t\t   .cc-module-config-detail {\n\t\t\t   padding-top: 0.5rem;\n\t\t   }\n\t\t   .cc-preview-container {\n\t\t\t   display:flex;\n\t\t\t   flex-wrap: wrap;\n\t\t\t   width: 100%;\n\t\t   }\n\n\t\t   .cc-preview-container .cc-card {\n\t\t\t   min-width: 50%;\n\t\t   }\n\t\t</style>\n\n\t\t<div class="cc-module-config-detail">\n\t\t\t<div>\n\t\t\t\t<div class="cc-collection-representation">\n\t\t\t\t\t<label for="cc-collection-representation-${moduleDetail.id}-collection">Collection</label>\n\t\t\t\t\t<select id="cc-module-config-${moduleDetail.id}-collection">\n\t\t\t\t\t  ${collectionsOptions}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="cc-collection-representation">\n\t\t\t\t    <label for="cc-module-config-${moduleDetail.id}-label">Label</label>\n\t\t\t\t\t<input type="text" id="cc-module-config-${moduleDetail.id}-label" \n\t\t\t\t\t\tvalue="${moduleConfig.label}" />\n\t\t\t\t\t<br clear="all" />\n\t\t\t\t    <label for="cc-module-config-${moduleDetail.id}-number">Number</label>\n\t\t\t\t\t<input type="text" id="cc-module-config-${moduleDetail.id}-number" \n\t\t\t\t\t     value="${moduleConfig.num}" />\n\t\t\t\t\t<br clear="all" />\n\t\t\t\t    <label for="cc-module-config-${moduleDetail.id}-date">Date</label>\n\t\t\t\t\t<input type="text" id="cc-module-config-${moduleDetail.id}-date" \n\t\t\t\t\t      value="">\n\t\t\t\t\t<br clear="all" />\n\t\t\t\t    <label for="cc-module-config-${moduleDetail.id}-description">Description</label>\n\t\t\t\t\t<textarea id="cc-module-config-${moduleDetail.id}-description">${moduleConfig.description}</textarea>\n\t\t\t\t</div>\n\t\t    </div>\n\t\t\t<div>\n\t\t\t\t<div class="cc-collection-representation">\n\t\t\t\t\t<label for="cc-collection-representation-${moduleDetail.id}-imageSize">Image size</label>\n\t\t\t\t\t<input id="cc-module-config-${moduleDetail.id}-imageSize" value="${moduleConfig.imageSize}">\n\t\t\t\t\t<br clear="all" />\n\t\t\t\t\t<label for="cc-collection-representation-${moduleDetail.id}-imageUrl">Image URL</label>\n\t\t\t\t\t<input type="text" id="cc-module-config-${moduleDetail.id}-imageUrl" \n\t\t\t\t\t        value="${moduleConfig.image}">\n\t\t\t\t</div>\n\t\t\t\t<div class="cc-module-config-imagePreview">\n\t\t\t\t  <div class="cc-preview-container">\n\t\t\t\t\t<div class="cc-card" aria-label="Preview">\n  \t\t\t\t\t\t<div class="cc-card-header">\n\t\t\t\t\t\t\t<div class="cc-card-header-image" \n\t\t\t\t\t\t\t     style="background-image:url('${moduleConfig.image}');">\n\t\t\t\t\t\t\t\t<div class="cc-card-header-hero" aria-hidden="true"></div>\n\t  \t\t\t\t\t\t</div>\n\t\t   \t\t\t\t    <a href="#module_${moduleDetail.id}" class="cc-card-link">\n\t  \t\t\t\t\t\t\t<div class="cc-card-header-content">\n\t    \t\t\t\t\t\t\t<h3 class="cc-card-header-title cc-ellipsis" title="${moduleDetail.name}">\n\t\t\t\t\t\t\t\t\t  ${moduleDetail.name}\n\t\t\t\t\t\t\t\t\t</h3>\n\t    \t\t\t\t\t\t\t<div class="cc-card-header-subtitle cc-ellipsis">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="cc-card-header-description">\n\t\t\t\t\t\t\t\t\t\t${moduleConfig.description}\n\t\t\t\t\t\t\t\t\t</div>\n\t  \t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t    </div>\n\t\t</div>\t\n\t\t`}showConfig(){const toggleAndCrumbs=document.getElementsByClassName("ic-app-nav-toggle-and-crumbs")[0];toggleAndCrumbs&&(toggleAndCrumbs.style.borderBottom="none",toggleAndCrumbs.insertAdjacentHTML("afterEnd",'\n\t\t<div id="cc-config-wrapper">\n\t\t<style>\n\t\t    #cc-config-wrapper {\n\t\t\t\tdisplay: block;\n\t\t\t\tborder-bottom: 1px solid #c7cdd1\n\t\t\t}\n\n\t\t\t#cc-config {\n\t\t\t\tfloat: right;\n\t\t\t\tdisplay: block;\n\t\t\t\tmax-width: 50%;\n\t\t\t\tmargin-top: -1em;\n\t\t\t\tmargin-right: 10em;\n\t\t\t\tmargin-bottom: 1em;\n\t\t\t\tpadding-bottom: 0.5em;\n\t\t\t\tbackground-color: #f5f5f5;\n\t\t\t}\n\n\t\t\t.cc-box-header {\n\t\t\t\tpadding-left: 0.5em;\n\t\t\t}\n\n\t\t\t.cc-box-header p {\n\t\t\t\tfont-size: 1.1em;\n\t\t\t\tfont-weight: bold;\n\t\t\t}\n\n\t\t\t.cc-box-body {\n\t\t\t\twidth: 500px;\n\t\t\t\tpadding-left: 0.5em;\n\t\t\t\tpadding-bottom: 1.em;\n\t\t\t}\n\n\t\t\t#cc-config-body {  display: grid; \n\t\t\t\tgrid-template-columns: 1fr 1fr; \n\t\t\t\tgrid-template-rows: 1fr; \n\t\t\t\tgap: 0px 1em; \n\t\t\t\tgrid-auto-flow: row; \n\t\t\t\tgrid-template-areas: ". .";\n\t\t\t\theight: 100%;\n\t\t\t}\n\n\t\t\t#cc-config-body p {\n\t\t\t\tfont-size: 0.9em;\n\t\t\t\tfont-weight: bold;\n\t\t\t}\n\n\t\t\t#cc-config-new-collection {\n\t\t\t}\n\n\t\t\t#cc-config-new-collection-button {\n\t\t\t\tleft: 50%;\n\t\t\t\ttransform: translateX(-50%);\n\t\t\t}\n\n\t\t\t.cc-existing-collection {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t\tfont-weight: normal;\n\t\t\t\tpadding-left: 0.5em;\n\t\t\t}\n\n\t\t\t.cc-existing-collection label {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t}\n\n\t\t\t.cc-existing-collection select {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t\twidth: 7rem;\n\t\t\t\theight: 2rem;\n\t\t\t}\n\n\t\t\t.cc-existing-collection p {\n\t\t\t\tmargin-top: 0.2em;\n\t\t\t\tmargin-bottom: 0.2em;\n\t\t\t}\n\t\t\n\t\t\t.cc-config-collection {\n\t\t\t\tpadding-top: 0.5em;\n\t\t\t\tpadding-left: 0.5em;\n\t\t\t}\n\n\t\t\t.cc-config-collection label {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t}\n\n\t\t\t.cc-config-collection input {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t}\n\n\t\t\t.cc-config-collection button {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t\tpadding: 0.5em 1em;\n\t\t\t}\n\t\t\t.cc-config-collection select {\n\t\t\t\tfont-size: 0.8em;\n\t\t\t\twidth: 7rem;\n\t\t\t\theight: 2rem;\n\t\t\t}\n\n\t\t\t.cc-collection-representation {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: space-around;\n\t\t\t}\n\n\t\t\t.cc-version {\n\t\t\t\tfont-size: 50%;\n\t\t\t\tfont-weight: normal;\n\t\t\t}\n\n\t\t\t</style>\n\n\t\t\t<div id="cc-config">\n\t\t\t \t<div class="cc-box-header">\n\t\t  \t\t  <p>Configure Canvas Collections\n\t\t\t\t\t\t<span class="cc-version">(v0.7.3)</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t    <div class="cc-box-body">\n\t\t\t\t  <div id="cc-config-body">\n\t\t\t\t    <div id="cc-config-existing-collections">\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\tExisting collections \n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="cc-config-new-collection">\n\t\t\t\t\t\t<p>Add a new collection</p>\n\t\t\t\t\t\t<div class="cc-config-collection border border-trbl">\n\t\t\t\t\t\t<div class="ic-Form-control" style="margin-bottom: 0px">\n\t\t\t\t\t\t  \t<input type="text" id="cc-config-new-collection-name" \n\t\t\t\t\t\t\t   placeholder="Name for new collection">\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="cc-collection-representation">\n\t\t\t\t\t\t\t<label for="cc-collection-newRepresentation">Representation</label>\n\t\t\t\t\t\t\t<select id="cc-collection-newRepresentation">\n\t\t\t\t\t\t\t\t<option id="cc-collection-newRepresentation-cards" value="cards">Cards</option>\n\t\t\t\t\t\t\t\t<option id="cc-collection-newRpresentation-table" value="table">Table</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<fieldset class="ic-Fieldset ic-Fieldset--radio-checkbox">\n\t\t\t\t\t\t\t<div class="ic-Checkbox-group">\n\t\t\t\t\t\t\t\t<div class="ic-Form-control ic-Form-control--checkbox">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" id="cc-config-new-collection-default">\n\t\t\t\t\t\t\t\t\t<label class="ic-Label" for="cc-config-new-collection-default">\n\t\t\t\t\t\t\t\t\t\t<small>Default collection?</small>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="ic-Form-control ic-Form-control--checkbox">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" id="cc-config-new-collection-all">\n\t\t\t\t\t\t\t\t\t<label class="ic-Label" for="cc-config-new-collection-all">\n\t\t\t\t\t\t\t\t\t\t<small>Include all modules?</small>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="ic-Form-control ic-Form-control--checkbox">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" id="cc-config-new-collection-unallocated">\n\t\t\t\t\t\t\t\t\t<label class="ic-Label" for="cc-config-new-collection-unallocated">\n\t\t\t\t\t\t\t\t\t\t<small>Include modules without a collection?</small>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button class="btn btn-primary" id="cc-config-new-collection-button">Add</button>\n\t\t\t\t\t\t</fieldset>\n\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t'));const ccSwitchContainer=document.getElementsByClassName("cc-switch-container")[0];ccSwitchContainer&&(ccSwitchContainer.style.borderBottom="none"),this.showExistingCollections()}showExistingCollections(){DEBUG&&console.log("cc_configugurationView::showExistingCollections()");const existingCollectionNames=this.model.getExistingCollectionNames();DEBUG&&console.log(existingCollectionNames);const existingCollectionsDiv=document.getElementById("cc-config-existing-collections"),numCollections=existingCollectionNames.length;let count=0;const defaultCollection=this.model.getDefaultCollection();existingCollectionNames.forEach((collectionName=>{const moduleCount=this.model.getModuleCount(collectionName),divExistingCollection=`\n\t\t\t<div class="cc-existing-collection border border-trbl" id="cc-collection-${collectionName}">\n\t\t\t\t<p>${collectionName} - (${moduleCount} ${"module"+(1!==moduleCount?"s":"")})\n\t\t\t\t<span class="cc-collection-move">\n\t\t\t\t<i class="icon-arrow-up" id="cc-collection-${collectionName}-up"></i>\n\t\t\t\t<i class="icon-arrow-down" id="cc-collection-${collectionName}-down"></i>\n\t\t\t\t</p>\n\n\t\t\t\t<div class="cc-collection-representation">\n\t\t\t\t\t<label for="cc-collection-${collectionName}-representation">Representation</label>\n\t\t\t\t \t<select id="cc-collection-${collectionName}-representation">\n\t\t\t\t\t\t<option id="cc-collection-${collectionName}-representation-cards" value="cards">Cards</option>\n\t\t\t\t\t\t<option id="cc-collection-${collectionName}-representation-table" value="table">Table</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- put the options --\x3e\n\t\t\t\t<fieldset class="ic-Fieldset ic-Fieldset--radio-checkbox">\n\t\t\t\t\t<div class="ic-Checkbox-group">\n\t\t\t\t\t\t<div class="ic-Form-control ic-Form-control--checkbox">\n\t\t\t\t\t\t\t<input type="checkbox" id="cc-config-collection-${collectionName}-default">\n\t\t\t\t\t\t\t<label class="ic-Label" for="cc-config-collection-${collectionName}-default">\n\t\t\t\t\t\t\t\tDefault collection?\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ic-Form-control ic-Form-control--checkbox">\n\t\t\t\t\t\t\t<input type="checkbox" id="cc-config-collection-${collectionName}-all">\n\t\t\t\t\t\t\t<label class="ic-Label" for="cc-config-collection-${collectionName}-all">\n\t\t\t\t\t\t\t\tInclude all modules?\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ic-Form-control ic-Form-control--checkbox">\n\t\t\t\t\t\t\t<input type="checkbox" id="cc-config-collection-${collectionName}-unallocated">\n\t\t\t\t\t\t\t<label class="ic-Label" for="cc-config-collection-${collectionName}-unallocated">\n\t\t\t\t\t\t\t\tInclude modules without a collection?\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</fieldset>\n\t\t\t</div>\n\t\t\t`;if(existingCollectionsDiv.insertAdjacentHTML("beforeEnd",divExistingCollection),defaultCollection===collectionName){const defaultCheckbox=document.getElementById(`cc-config-collection-${collectionName}-default`);defaultCheckbox&&(defaultCheckbox.checked=!0)}const representation=this.model.getCollectionRepresentation(collectionName),representationOption=document.getElementById(`cc-collection-${collectionName}-representation-${representation}`);if(representationOption&&(representationOption.selected=!0),0===count){const upButton=document.getElementById(`cc-collection-${collectionName}-up`);upButton&&upButton.remove()}else if(count===numCollections-1){const downButton=document.getElementById(`cc-collection-${collectionName}-down`);downButton&&downButton.remove()}count+=1}))}removeConfig(){const configDiv=document.getElementById("cc-config-wrapper");if(configDiv){configDiv.remove();const toggleAndCrumbs=document.getElementsByClassName("ic-app-nav-toggle-and-crumbs")[0];toggleAndCrumbs&&(toggleAndCrumbs.style.borderBottom="1px solid #c7cdd1")}const ccSwitchContainer=document.getElementsByClassName("cc-switch-container")[0];ccSwitchContainer&&(ccSwitchContainer.style.borderBottom="1px solid #c7cdd1")}addCcBundle(){if(document.getElementsByClassName("cc-switch-container")[0])return;document.querySelector("div#application").insertAdjacentHTML("afterbegin",'\n\t\t <style>\n\t\t /* The switch - the box around the slider */\n.cc-switch {\n  position: relative;\n  display: inline-block;\n  width: 2rem; \n  height: 1.2rem;\n  margin-top: .75rem;\n  margin-right: 0.5rem\n}\n\n/* Hide default HTML checkbox */\n.cc-switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n/* The slider */\n.cc-slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  -webkit-transition: .4s;\n  transition: .4s;\n}\n\n.cc-slider:before {\n  position: absolute;\n  content: "";\n  height: 0.9rem;\n  width: 0.9rem;\n  left: 2px;\n  bottom: 2px;\n  background-color: white;\n  -webkit-transition: .4s;\n  transition: .4s;\n}\n\ninput:checked + .cc-slider {\n  background-color: #328c04;\n}\n\ninput:focus + .cc-slider {\n  box-shadow: 0 0 1px #2196F3;\n}\n\ninput:checked + .cc-slider:before {\n  -webkit-transform: translateX(1rem);\n  -ms-transform: translateX(1rem);\n  transform: translateX(1rem);\n}\n\n/* Rounded sliders */\n.cc-slider.cc-round {\n  border-radius: 1.1rem;\n}\n\n.cc-slider.cc-round:before {\n  border-radius: 50%;\n}\n\n.cc-switch-container {\n\tbackground-color: #f5f5f5;\n\tborder: 1px solid #c7cdd1;\n\tcolor: var(--ic-brand-font-color-dark);\n\tdisplay: flex;\n\tposition:relative;\n}\n\n.cc-switch-title {\n\tmargin: 0.5rem\n}\n\n/* styles for the module configs */\n\t\t    .cc-module-config {\n\t\t\t\tpadding-left: 0.5em;\n\t\t\t\tfont-size: smaller;\n\t\t\t\tmargin:0;\n\t\t\t\tfont-weight: bold;\n\t\t\t}\n\n\n\t\t\t.cc-module-config-detail {  \n\t\t\t\tdisplay: grid; \n\t\t\t\tgrid-template-columns: 1fr 1fr; \n\t\t\t\tgrid-template-rows: 1fr; \n\t\t\t\tgap: 0px 1em; \n\t\t\t\tgrid-auto-flow: row; \n\t\t\t\tgrid-template-areas: ". .";\n\t\t\t\theight: 100%;\n\t\t\t}\n\n\n\n\t\t </style>\n\t\t\t');let cc_on="";this.model.isOn()&&(cc_on="checked");const CC_BUNDLE_HTML=`\n\t\t<div class="cc-switch-container">\n\t\t  <div class="cc-switch-title">\n\t\t    <i id="configShowSwitch" class="icon-mini-arrow-right"></i> <small>Canvas Collections</small>\n\t\t\t<a target="_blank"\n\t\t\t   href="https://github.com/djplaner/canvas-collections/blob/v1/user-docs/about.md#About-canvas-collections">\n\t\t\t   <i class="icon-question"></i>\n\t\t   </a>\n\t\t  </div>\n\t\t<label class="cc-switch">\n\t\t    <input type="checkbox" class="cc-toggle-checkbox" id="cc-switch" ${cc_on}>\n\t\t\t<span class="cc-slider cc-round"></span>\n\t\t</label>\n\t   </div>\n\t\t`;let easy_student_view=document.querySelector("a#easy_student_view");if(easy_student_view){easy_student_view.insertAdjacentHTML("afterend",CC_BUNDLE_HTML);const configShowSwitch=document.getElementById("configShowSwitch");configShowSwitch.onclick=event=>this.controller.toggleConfigShowSwitch(event);document.getElementById("cc-switch").onchange=event=>this.controller.toggleOffOnSwitch(event),this.model.isOn()||configShowSwitch.remove()}else console.error("cc_ConfigurationView.addCcBundle() - could not find a#easy_student_view")}fileTest(event){console.log("---------------------- fileTest clicked")}}class cc_ConfigurationController{constructor(controller){DEBUG&&console.log("-------------- cc_ConfigurationController.constructor()"),this.parentController=controller,this.model=new cc_ConfigurationModel(this),this.view=new cc_ConfigurationView(this.model,this),this.view.display()}toggleConfigShowSwitch(event){DEBUG&&console.log("-------------- cc_ConfigurationController.toggleConfigShowSwitch()");const className=event.target.className;let status=this.model.getConfigShowClass(),newClass=this.model.getOtherConfigShowClass(className);DEBUG&&console.log(`changing to ${newClass} current setting is ${status}`),this.model.setConfigShowClass(newClass),this.view.display()}toggleModuleConfigSwitch(event){DEBUG&&console.log("-------------- cc_ConfigurationController.toggleModuleConfigSwitch()");const className=event.target.className;let idString=event.target.id;const moduleId=parseInt(idString.match(/cc-module-config-(\d+)-switch/)[1]);this.model.setModuleConfigClass(moduleId,className),this.view.display()}toggleOffOnSwitch(event){DEBUG&&console.log("-------------- cc_ConfigurationController.toggleOffOnSwitch()");const checked=event.target.checked,currentlyOn=this.model.isOn();DEBUG&&console.log(`currently on ${currentlyOn} and checked is ${checked}`),checked?(this.model.turnOn(),this.parentController.execute()):(this.model.turnOff(),this.parentController.turnOff()),this.parentController.saveConfig()}}class CollectionsModel{constructor(controller){DEBUG&&console.log("-------------- CollectionsModel.constructor()"),this.controller=controller,this.cc_configuration=this.controller.parentController.cc_configuration,this.createModuleCollections(),void 0===this.currentCollection&&(this.currentCollection=this.getDefaultCollection())}getDefaultCollection(){return this.cc_configuration.DEFAULT_ACTIVE_COLLECTION}setCurrentCollection(newCollection){this.currentCollection=newCollection}getCollections(){return Object.keys(this.cc_configuration.COLLECTIONS)}getCurrentCollection(){return this.currentCollection}getCurrentCollectionDescription(){return this.cc_configuration.COLLECTIONS[this.currentCollection].description}getCurrentCollectionRepresentation(){return this.cc_configuration.COLLECTIONS[this.currentCollection].representation}getCollectionRepresentation(collection){return this.cc_configuration.COLLECTIONS[collection].representation}getCollectionNames(){return Object.keys(this.cc_configuration.COLLECTIONS)}getCollectionsModules(collection=""){if(""===collection)return this.cc_configuration.MODULES;const modules=this.cc_configuration.MODULES;return Object.keys(modules).filter((key=>modules[key].collection===collection)).map((key=>modules[key]))}createModuleCollections(){DEBUG&&console.log("-------------- cc_CollectionsModel.createModuleCollections()");let canvasModules=this.controller.parentController.moduleDetails,ccModules=this.cc_configuration.MODULES;this.modulesCollections=[];for(let i=0;i<canvasModules.length;i++){let details={};for(let key in canvasModules[i])details[key]=canvasModules[i][key];let ccModule=ccModules[canvasModules[i].name];if(ccModule)for(let key in ccModule)details[key]=ccModule[key];details.cc_itemsCompleted=this.getItemsCompleted(details),this.modulesCollections.push(details)}console.log(this.modulesCollections)}getItemsCompleted(module){let itemsCompleted={numRequired:0,numCompleted:0};if(module.items){for(let i=0;i<module.items.length;i++){let item=module.items[i];item.completion_requirement&&(itemsCompleted.numRequired++,item.completion_requirement.completed&&itemsCompleted.numCompleted++)}if(0!==itemsCompleted.numRequired)return itemsCompleted}}getModules(){return this.controller.parentController.moduleDetails}getModulesCollections(){return this.modulesCollections}}class NavView extends cc_View{constructor(model,controller){super(model,controller)}display(){DEBUG&&console.log("-------------- cc_NavView.display()");let div=document.getElementById("cc-canvas-collections"),navBar=this.generateNavBar();div.insertAdjacentElement("beforeend",navBar)}generateNavBar(){let navBar=document.createElement("div");navBar.className="cc-nav";navBar.insertAdjacentHTML("afterbegin","\n\t\t<style>\n.cc-content {\n    clear:both;\n}\n\n.cc-nav { \n    font-size: small;\n}\n\n.cc-nav ul  {\n\tlist-style-type: none;\n    margin: 0;\n    padding: 0;\n    overflow: hidden ;\n    background-color: #eee; \n\tdisplay: table;\n\ttable-layout: fixed;\n\twidth: 100%\n}\n\nli.cc-active {\n    background-color: var(--ic-brand-button--primary-bgd) !important; \n    font-weight: bold; \n}\n\nli.cc-active a {\n\tcolor: var(--ic-brand-button--primary-text) !important; \n\tborder-top: 4px solid var(--ic-brand-button--primary-bgd) !important; \n}\n\nli.cc-close {\n    float: right !important;\n    border-right: none !important;\n}\n\n.cc-nav ul li {\n\tdisplay: table-cell;\n\twidth: 100%;\n /*   border-right: 1px solid #000; */\n\tfloat: none;\n}\n\nli.cc-nav a {\n    display: block;\n    text-align: center !important;\n    text-decoration: none;\n    color: #2d3b45;  \n\tpadding: 1em 0.8em !important;\n\tborder-top: 4px solid #eee; \n\tbox-sizing: border-box;\n\tfont-size: 1.2em;\n\ttransition: background 0.3s linear 0s !important;\n}\n\n.cc-nav li a:hover {\n /*   background-color: #111; */\n    background-color: var(--ic-brand-button--primary-bgd); \n\tborder-top: 4px solid var(--ic-brand-button--primary-bgd); */\n\t  color: rgb(255, 255, 255) !important;\n  background: rgba(51, 51, 51, 0.9) !important;\n  text-decoration: none !important;\n  color: rgb(255, 255, 255) !important;\n/*  border-top: 4px solid #c12525; */\n}\n\n.cc-nav li:nth-child(4) {\n    border-right: none;\n}\n</style>\n\t\t");let count=0,navList=document.createElement("ul");for(let collection of this.model.getCollectionNames()){let collectionDetails=this.model.cc_configuration.COLLECTIONS[collection],icon="";""!==collectionDetails.icon&&(icon=`<i class="${collectionDetails.icon}"></i>`);let navElement=`<a href="#">${icon} ${collection}</a> `,navItem=document.createElement("li");navItem.className="cc-nav",(collection===this.model.currentCollection||void 0===this.model.currentCollection&&0===count)&&navItem.classList.add("cc-active"),count+=1,navItem.onclick=event=>this.controller.navigateCollections(event),navItem.innerHTML=navElement,navList.appendChild(navItem)}return navBar.appendChild(navList),navBar}}class CardsView extends cc_View{constructor(model,controller){super(model,controller),this.currentCollection=this.model.getCurrentCollection()}display(){DEBUG&&console.log("-------------- cc_CardsView.display()");let div=document.getElementById("cc-canvas-collections");const descriptionHtml=`<div class="cc-description">${this.model.getCurrentCollectionDescription()}</div>`;div.insertAdjacentHTML("beforeend",descriptionHtml);let cards=this.generateCards();div.insertAdjacentElement("beforeend",cards)}generateCards(){let cardContainer=document.createElement("div");cardContainer.classList.add("cc-collection-container"),cardContainer.insertAdjacentHTML("afterbegin","\n\t\t<style>\n\t\t\t.cc-collection-container {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-wrap: wrap;\n\t\t\t\tmargin: -.75rem;\n\t\t\t}\n\n\t\t\t.cc-card {\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\tbox-shadow: 0 2px 5px rgba(0,0,0,.3);\n\t\t\t\tborder-radius: 4px;\n\t\t\t\toverflow: hidden;\n\t\t\t\tbackground: #fff;\n\t\t\t\tmax-width: 30%;\n\t\t\t\twidth: 30%;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tvertical-align: top;\n\t\t\t\tpadding: .75rem;\n\t\t\t\tmargin: 1em 0 0 1em;\n\t\t\t\tflex-direction: column;\n\t\t\t\tdisplay: flex;\n\t\t\t}\n\n\t\t\t.cc-card-header {\n\t\t\t\tposition: relative;\n\t\t\t\tcursor: pointer;\n\t\t\t\tbox-sizing: border-box;\n\t\t\t}\n\n\t\t\t.screenreader-only {\n\t\t\t\tborder: 0;\n\t\t\t\tclip: rect(0 0 0 0);\n\t\t\t\theight: 1px;\n\t\t\t\tmargin: -1px;\n\t\t\t\toverflow: hidden;\n\t\t\t\tpadding: 0;\n\t\t\t\tposition: absolute;\n\t\t\t\twidth: 1px;\n\t\t\t\ttransform: translatez(0);\n\t\t\t}\n\n\t\t\t.cc-card-header-image {\n\t\t\t\tbackground-size: cover;\n\t\t\t\tbackground-position: center center;\n\t\t\t\tbackground-repeat: no-repeat;\n\t\t\t}\n\n\t\t\t.cc-card-header-hero {\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\theight: 10rem;\n\t\t\t\tborder: 1px solid rgb(0,0,0,.1);\n\t\t\t}\n\n\t\t\t.cc-card-link {\n\t\t\t\tcolor: var(--ic-link-color);\n\t\t\t\ttext-decision: none;\n\t\t\t}\n\n\t\t\t.cc-card-header-content {\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\tpadding: 1em 0 0.5em 0;\n\t\t\t\tbackground: #ffff;\n\t\t\t\tcolor: #000000;\n\t\t\t}\n\n\t\t\t.cc-card-header-title {\n\t\t\t\ttransition: all .2s ease-out;\n\t\t\t\ttransform: translate3d(0,0,0);\n\t\t\t\tpadding: 0;\n\t\t\t\tmargin: 0;\n\t\t\t\tline-height: 1.3;\n\t\t\t\tfont-size: 1.1rem;\n\t\t\t\tfont-weight: bold;\n\t\t\t}\n\n\t\t\t.cc-ellipsis {\n\t\t\t\tflex: 1 1 auto;\n\t\t\t\t/*white-space: nowrap;\n\t\t\t\toverflow: hidden;\n\t\t\t\ttext-overflow: ellipsis; */\n\t\t\t}\n\n\t\t\t.cc-card-header-subtitle {\n\t\t\t\tcolor: var(--ic-brand-font-color-dark-lightened-30);\n\t\t\t\tline-height: 1.3;\n\t\t\t\tpadding:0;\n\t\t\t\tmargin-top: 0.2rem \n\t\t\t}\n\n\t\t\t.cc-card-header-description {\n\t\t\t\tline-height: 1.3;\n\t\t\t\tfont-size: 0.8rem;\n\t\t\t\theight: 1rem;\n\t\t\t\tfont-weight: normal;\n\t\t\t}\n\t\t");const currentCollection=this.model.getCurrentCollection();for(let module of this.model.getModulesCollections()){if(console.log(module),module.collection!==currentCollection){document.querySelector(`div.context_module[data-module-id="${module.id}"]`).style.display="none";continue}document.querySelector(`div.context_module[data-module-id="${module.id}"]`).style.display="block";let cardHtml=`\n<div class="cc-card" aria-label="Module ${module.name}">\n  <div class="cc-card-header">\n    <span class="screenreader-only">Module image for ${module.name}</span>\n\t<div class="cc-card-header-image" style="background-image: url('${module.image}');">\n\t  <div class="cc-card-header-hero" aria-hidden="true">\n\t  </div>\n\t</div>\n\t<a href="#module_${module.id}" class="cc-card-link">\n\t  <div class="cc-card-header-content">\n\t    <h3 class="cc-card-header-title cc-ellipsis" title="${module.name}">\n\t\t  ${module.name}\n\t\t</h3>\n\t    <div class="cc-card-header-subtitle cc-ellipsis" title="TODO SOME LABEL">\n\t\t</div>\n\t\t<div class="cc-card-header-description">\n\t\t  ${module.description}\n\t\t</div>\n\t  </div>\n\t</a>\n\t<div>\n       \x3c!-- the date stuff could go here --\x3e\n\t</div>\n  </div>\n  <nav class="ic-DashboardCard__action-container" aria-label="Actions for ${module.name}"></nav>\n</div>\n\t\t\t`;cardContainer.insertAdjacentHTML("beforeend",cardHtml)}return cardContainer}}class TableView extends cc_View{constructor(model,controller){super(model,controller),this.currentCollection=this.model.getCurrentCollection()}display(){DEBUG&&console.log("-------------- TableView.display()");let div=document.getElementById("cc-canvas-collections"),message=document.createElement("div");message.className="cc-message",message.innerHTML="<h1> Hello from TableView </h1>",div.insertAdjacentElement("beforeend",message)}}class CollectionOnlyView extends cc_View{constructor(model,controller){super(model,controller),this.currentCollection=this.model.getCurrentCollection()}display(){DEBUG&&console.log("-------------- TableView.display()");let div=document.getElementById("cc-canvas-collections");const description=this.model.getCurrentCollectionDescription();let message=document.createElement("div");message.className="cc-message",message.innerHTML=description,div.insertAdjacentElement("beforeend",message)}}
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const DEFAULT_PERIOD="3221",MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CALENDAR={3221:{0:{start:"2022-03-07",stop:"2022-03-13"},1:{start:"2022-03-14",stop:"2022-03-20"},2:{start:"2022-03-21",stop:"2022-03-28"},3:{start:"2022-03-28",stop:"2022-04-03"},4:{start:"2022-04-04",stop:"2022-04-10"},5:{start:"2022-04-18",stop:"2022-04-24"},6:{start:"2022-04-25",stop:"2022-05-01"},7:{start:"2022-05-02",stop:"2022-05-08"},8:{start:"2022-05-09",stop:"2022-05-15"},9:{start:"2022-05-16",stop:"2022-05-22"},10:{start:"2022-05-23",stop:"2022-05-29"},11:{start:"2022-05-30",stop:"2022-06-05"},12:{start:"2022-06-06",stop:"2022-06-12"},13:{start:"2022-06-13",stop:"2022-06-19"},14:{start:"2022-06-20",stop:"2022-06-26"},15:{start:"2022-06-27",stop:"2022-07-03"},exam:{start:"2022-06-13",stop:"2022-06-25"}},"3221QCM":{0:{start:"2022-02-21",stop:"2022-02-27"},1:{start:"2022-02-28",stop:"2022-03-06"},2:{start:"2022-03-07",stop:"2022-03-13"},3:{start:"2022-03-14",stop:"2022-03-20"},4:{start:"2022-03-21",stop:"2022-03-27"},5:{start:"2022-03-28",stop:"2022-04-03"},6:{start:"2022-04-04",stop:"2022-04-10"},7:{start:"2022-04-18",stop:"2022-04-24"},8:{start:"2022-04-25",stop:"2022-05-01"},9:{start:"2022-05-09",stop:"2022-05-15"},10:{start:"2022-05-16",stop:"2022-05-22"},11:{start:"2022-05-23",stop:"2022-05-29"},12:{start:"2022-05-30",stop:"2022-06-05"},13:{start:"2022-06-06",stop:"2022-06-12"},14:{start:"2022-06-13",stop:"2022-06-19"},15:{start:"2022-06-20",stop:"2022-07-26"},exam:{start:"2022-06-13",stop:"2022-06-25"}},3225:{0:{start:"2022-07-11",stop:"2022-07-17"},1:{start:"2022-07-18",stop:"2022-07-24"},2:{start:"2022-07-25",stop:"2022-07-31"},3:{start:"2022-08-01",stop:"2022-08-07"},4:{start:"2022-08-08",stop:"2022-08-14"},5:{start:"2022-08-22",stop:"2022-08-28"},6:{start:"2022-08-29",stop:"2022-09-04"},7:{start:"2022-09-05",stop:"2022-09-11"},8:{start:"2022-09-12",stop:"2022-09-18"},9:{start:"2022-09-19",stop:"2022-09-25"},10:{start:"2022-09-26",stop:"2022-10-02"},11:{start:"2022-10-03",stop:"2022-10-09"},12:{start:"2022-10-10",stop:"2022-10-16"},13:{start:"2022-10-17",stop:"2022-10-23"},14:{start:"2022-10-24",stop:"2022-10-30"},15:{start:"2022-10-31",stop:"2022-11-06"},exam:{start:"2022-10-20",stop:"2022-10-29"}},"3225QCM":{0:{start:"2022-07-18",stop:"2022-07-24"},1:{start:"2022-07-25",stop:"2022-07-31"},2:{start:"2022-08-01",stop:"2022-08-07"},3:{start:"2022-08-08",stop:"2022-08-14"},4:{start:"2022-08-15",stop:"2022-08-21"},5:{start:"2022-08-22",stop:"2022-08-28"},6:{start:"2022-09-05",stop:"2022-09-11"},7:{start:"2022-09-12",stop:"2022-09-18"},8:{start:"2022-09-19",stop:"2022-09-25"},9:{start:"2022-10-03",stop:"2022-10-09"},10:{start:"2022-10-10",stop:"2022-10-16"},11:{start:"2022-10-17",stop:"2022-10-23"},12:{start:"2022-10-24",stop:"2022-10-30"},13:{start:"2022-10-31",stop:"2022-11-06"},14:{start:"2022-11-07",stop:"2022-11-13"},15:{start:"2022-11-14",stop:"2022-07-20"},exam:{start:"2022-11-07",stop:"2022-11-19"}},3228:{0:{start:"2022-10-31",stop:"2022-11-06"},1:{start:"2022-11-07",stop:"2022-11-13"},2:{start:"2022-11-14",stop:"2022-11-20"},3:{start:"2022-11-21",stop:"2022-11-27"},4:{start:"2022-11-28",stop:"2022-12-04"},5:{start:"2022-12-05",stop:"2022-12-11"},6:{start:"2022-12-12",stop:"2022-12-18"},7:{start:"2022-12-19",stop:"2022-12-25"},8:{start:"2023-01-09",stop:"2023-01-15"},9:{start:"2023-01-16",stop:"2023-01-22"},10:{start:"2023-01-23",stop:"2023-01-29"},11:{start:"2023-01-30",stop:"2023-02-05"},12:{start:"2023-02-06",stop:"2023-02-12"},13:{start:"2023-02-13",stop:"2023-02-19"},14:{start:"2023-02-20",stop:"2023-02-26"},15:{start:"2023-02-27",stop:"2023-03-05"}},2211:{0:{start:"2021-02-22",stop:"2021-02-28"},1:{start:"2021-03-01",stop:"2021-03-07"},2:{start:"2021-03-08",stop:"2021-03-14"},3:{start:"2021-03-15",stop:"2021-03-21"},4:{start:"2021-03-22",stop:"2021-03-28"},5:{start:"2021-03-29",stop:"2021-04-04"},6:{start:"2021-04-05",stop:"2021-04-11"},7:{start:"2021-04-12",stop:"2021-04-18"},8:{start:"2021-04-19",stop:"2021-04-25"},9:{start:"2021-04-26",stop:"2021-05-02"},10:{start:"2021-05-03",stop:"2021-05-09"},11:{start:"2021-05-10",stop:"2021-05-16"},12:{start:"2021-05-17",stop:"2021-05-23"},13:{start:"2021-05-24",stop:"2021-05-30"},14:{start:"2021-05-31",stop:"2021-06-06"},exam:{start:"2021-05-31",stop:"2021-06-06"}},2213:{1:{start:"2021-05-31",stop:"2021-06-06"},2:{start:"2021-06-07",stop:"2021-06-13"},3:{start:"2021-06-14",stop:"2021-06-20"},4:{start:"2021-06-21",stop:"2021-06-27"},5:{start:"2021-06-28",stop:"2021-07-04"},6:{start:"2021-07-05",stop:"2021-07-11"},7:{start:"2021-07-12",stop:"2021-07-18"},8:{start:"2021-07-19",stop:"2021-07-25"},9:{start:"2021-07-26",stop:"2021-08-01"},10:{start:"2021-08-02",stop:"2021-08-08"},11:{start:"2021-08-09",stop:"2021-08-15"},12:{start:"2021-08-16",stop:"2021-08-22"},13:{start:"2021-08-23",stop:"2021-08-29"},exam:{start:"2021-08-30",stop:"2021-09-05"}},2215:{0:{start:"2021-08-23",stop:"2021-08-29"},1:{start:"2021-08-30",stop:"2021-09-05"},2:{start:"2021-09-06",stop:"2021-09-12"},3:{start:"2021-09-13",stop:"2021-09-19"},4:{start:"2021-09-20",stop:"2021-09-26"},5:{start:"2021-09-27",stop:"2021-10-03"},6:{start:"2021-10-04",stop:"2021-10-10"},7:{start:"2021-10-11",stop:"2021-10-17"},8:{start:"2021-10-18",stop:"2021-10-24"},9:{start:"2021-10-25",stop:"2021-10-31"},10:{start:"2021-11-01",stop:"2021-11-07"},11:{start:"2021-11-08",stop:"2021-11-14"},12:{start:"2021-11-15",stop:"2021-11-21"},13:{start:"2021-11-22",stop:"2021-11-28"},exam:{start:"2021-11-29",stop:"2021-12-05"}},2217:{0:{start:"2021-11-22",stop:"2021-11-28"},1:{start:"2021-11-29",stop:"2021-12-05"},2:{start:"2021-12-06",stop:"2021-12-12"},3:{start:"2021-12-13",stop:"2021-12-19"},4:{start:"2021-12-20",stop:"2021-12-26"},5:{start:"2021-12-27",stop:"2022-01-02"},6:{start:"2022-01-03",stop:"2022-01-09"},7:{start:"2022-01-10",stop:"2022-01-16"},8:{start:"2022-01-17",stop:"2022-01-23"},9:{start:"2022-01-24",stop:"2022-01-30"},10:{start:"2022-01-31",stop:"2022-02-06"},11:{start:"2022-02-07",stop:"2022-02-13"},12:{start:"2022-02-14",stop:"2022-02-20"},13:{start:"2022-02-21",stop:"2022-02-27"},exam:{start:"2022-02-28",stop:"2022-03-04"}},3218:{0:{start:"2021-11-01",stop:"2021-11-07"},1:{start:"2021-11-08",stop:"2021-11-14"},2:{start:"2021-11-15",stop:"2021-11-21"},3:{start:"2021-11-22",stop:"2021-11-28"},4:{start:"2021-11-29",stop:"2021-12-05"},5:{start:"2021-12-06",stop:"2021-12-12"},6:{start:"2021-12-13",stop:"2021-12-19"},7:{start:"2021-12-20",stop:"2021-12-26"},8:{start:"2022-01-10",stop:"2022-01-16"},9:{start:"2022-01-17",stop:"2022-01-23"},10:{start:"2022-01-24",stop:"2022-01-30"},11:{start:"2022-01-31",stop:"2022-02-06"},12:{start:"2022-02-07",stop:"2022-02-13"},13:{start:"2022-02-14",stop:"2022-02-20"},14:{start:"2022-02-21",stop:"2022-02-27"},15:{start:"2022-02-28",stop:"2022-03-06"},exam:{start:"2022-02-17",stop:"2022-02-26"}},3215:{0:{start:"2021-07-12",stop:"2021-07-18"},1:{start:"2021-07-19",stop:"2021-07-25"},2:{start:"2021-07-26",stop:"2021-08-01"},3:{start:"2021-08-02",stop:"2021-08-08"},4:{start:"2021-08-16",stop:"2021-08-22"},5:{start:"2021-08-23",stop:"2021-08-29"},6:{start:"2021-08-30",stop:"2021-09-05"},7:{start:"2021-09-06",stop:"2021-09-12"},8:{start:"2021-09-13",stop:"2021-09-19"},9:{start:"2021-09-20",stop:"2021-09-26"},10:{start:"2021-09-27",stop:"2021-10-03"},11:{start:"2021-10-04",stop:"2021-10-10"},12:{start:"2021-10-11",stop:"2021-10-17"},13:{start:"2021-10-18",stop:"2021-10-24"},14:{start:"2021-10-25",stop:"2021-10-31"},15:{start:"2021-11-01",stop:"2021-11-07"},exam:{start:"2021-10-21",stop:"2021-10-31"}},3211:{0:{start:"2021-03-01",stop:"2021-03-07"},1:{start:"2021-03-08",stop:"2021-03-14"},2:{start:"2021-03-15",stop:"2021-03-21"},3:{start:"2021-03-22",stop:"2021-03-28"},4:{start:"2021-03-29",stop:"2021-04-04"},5:{start:"2021-04-12",stop:"2021-04-18"},6:{start:"2021-04-19",stop:"2021-04-25"},7:{start:"2021-04-26",stop:"2021-05-02"},8:{start:"2021-05-03",stop:"2021-05-09"},9:{start:"2021-05-10",stop:"2021-05-16"},10:{start:"2021-05-17",stop:"2021-05-23"},11:{start:"2021-05-24",stop:"2021-05-30"},12:{start:"2021-05-31",stop:"2021-06-06"},13:{start:"2021-06-07",stop:"2021-06-13"},14:{start:"2021-06-14",stop:"2021-06-20"},15:{start:"2021-06-21",stop:"2021-06-27"},exam:{start:"2021-06-10",stop:"2021-06-19"}},"3215QCM":{0:{start:"2021-07-12",stop:"2021-07-18"},1:{start:"2021-07-19",stop:"2021-07-25"},2:{start:"2021-07-26",stop:"2021-08-01"},3:{start:"2021-08-02",stop:"2021-08-08"},4:{start:"2021-08-09",stop:"2021-08-15"},5:{start:"2021-08-16",stop:"2021-08-22"},6:{start:"2021-08-30",stop:"2021-09-05"},7:{start:"2021-09-06",stop:"2021-09-12"},8:{start:"2021-09-13",stop:"2021-09-19"},9:{start:"2021-09-20",stop:"2021-09-26"},10:{start:"2021-10-04",stop:"2021-10-10"},11:{start:"2021-10-11",stop:"2021-10-17"},12:{start:"2021-10-18",stop:"2021-10-24"},13:{start:"2021-10-25",stop:"2021-10-31"},14:{start:"2021-11-01",stop:"2021-11-07"},15:{start:"2021-11-08",stop:"2021-11-14"},exam:{start:"2021-10-30",stop:"2021-11-13"}},"3211QCM":{0:{start:"2021-02-22",stop:"2021-02-28"},1:{start:"2021-03-01",stop:"2021-03-07"},2:{start:"2021-03-08",stop:"2021-03-14"},3:{start:"2021-03-15",stop:"2021-03-21"},4:{start:"2021-03-22",stop:"2021-03-29"},5:{start:"2021-03-29",stop:"2021-04-04"},6:{start:"2021-04-12",stop:"2021-04-18"},7:{start:"2021-04-19",stop:"2021-04-25"},8:{start:"2021-04-26",stop:"2021-05-02"},9:{start:"2021-05-10",stop:"2021-05-16"},10:{start:"2021-05-17",stop:"2021-05-23"},11:{start:"2021-05-24",stop:"2021-05-30"},12:{start:"2021-05-31",stop:"2021-06-06"},13:{start:"2021-06-07",stop:"2021-03-13"},14:{start:"2021-06-14",stop:"2021-03-20"},15:{start:"2021-06-21",stop:"2021-03-26"},exam:{start:"2021-06-12",stop:"2021-06-26"}},2201:{0:{start:"2020-02-24",stop:"2020-03-01"},1:{start:"2020-03-02",stop:"2020-03-08"},2:{start:"2020-03-09",stop:"2020-03-15"},3:{start:"2020-03-16",stCop:"2020-03-22"},4:{start:"2020-03-23",stop:"2020-03-29"},5:{start:"2020-03-30",stop:"2020-04-05"},6:{start:"2020-04-06",stop:"2020-04-12"},7:{start:"2020-04-13",stop:"2020-04-19"},8:{start:"2020-04-20",stop:"2020-04-26"},9:{start:"2020-04-27",stop:"2020-05-03"},10:{start:"2020-05-04",stop:"2020-05-10"},11:{start:"2020-05-11",stop:"2020-05-17"},12:{start:"2020-05-18",stop:"2020-05-24"},13:{start:"2020-05-25",stop:"2020-05-31"},14:{start:"2020-06-01",stop:"2020-06-05"},exam:{start:"2020-06-01",stop:"2020-06-05"}},2203:{0:{start:"2020-05-25",stop:"2020-05-31"},1:{start:"2020-06-01",stop:"2020-06-07"},2:{start:"2020-06-08",stop:"2020-06-14"},3:{start:"2020-06-15",stop:"2020-06-21"},4:{start:"2020-06-22",stop:"2020-06-28"},5:{start:"2020-06-29",stop:"2020-07-05"},6:{start:"2020-07-06",stop:"2020-07-12"},7:{start:"2020-07-13",stop:"2020-07-19"},8:{start:"2020-07-20",stop:"2020-07-26"},9:{start:"2020-07-27",stop:"2020-08-02"},10:{start:"2020-08-03",stop:"2020-08-09"},11:{start:"2020-08-10",stop:"2020-05-17"},12:{start:"2020-08-17",stop:"2020-05-24"},13:{start:"2020-08-24",stop:"2020-05-31"},14:{start:"2020-08-31",stop:"2020-09-06"},exam:{start:"2020-08-31",stop:"2020-09-04"}},2205:{0:{start:"2020-08-24",stop:"2020-09-30"},1:{start:"2020-08-31",stop:"2020-09-06"},2:{start:"2020-09-07",stop:"2020-09-13"},3:{start:"2020-09-14",stop:"2020-09-20"},4:{start:"2020-09-21",stop:"2020-09-27"},5:{start:"2020-09-28",stop:"2020-10-04"},6:{start:"2020-10-05",stop:"2020-10-11"},7:{start:"2020-10-12",stop:"2020-10-19"},8:{start:"2020-10-19",stop:"2020-10-25"},9:{start:"2020-10-26",stop:"2020-11-01"},10:{start:"2020-11-02",stop:"2020-11-08"},11:{start:"2020-11-09",stop:"2020-11-15"},12:{start:"2020-11-16",stop:"2020-11-22"},13:{start:"2020-11-23",stop:"2020-11-29"},14:{start:"2020-11-30",stop:"2020-12-06"},15:{start:"2020-12-07",stop:"2020-12-13"},exam:{start:"2020-12-07",stop:"2020-12-13"}},2207:{0:{start:"2020-11-23",stop:"2020-11-29"},1:{start:"2020-11-30",stop:"2020-12-06"},2:{start:"2020-12-07",stop:"2020-12-13"},3:{start:"2020-12-14",stop:"2020-12-20"},4:{start:"2020-12-21",stop:"2020-12-27"},5:{start:"2020-12-28",stop:"2021-01-03"},6:{start:"2021-01-04",stop:"2021-01-10"},7:{start:"2021-01-11",stop:"2021-01-17"},8:{start:"2021-01-18",stop:"2021-01-24"},9:{start:"2021-01-25",stop:"2021-01-31"},10:{start:"2021-02-01",stop:"2021-02-07"},11:{start:"2021-02-08",stop:"2021-02-14"},12:{start:"2021-02-15",stop:"2021-02-21"},13:{start:"2021-02-22",stop:"2021-02-28"},14:{start:"2021-03-01",stop:"2021-03-07"},15:{start:"2021-03-08",stop:"2021-03-14"},exam:{start:"2021-03-01",stop:"2021-03-07"}},3208:{0:{start:"2020-10-26",stop:"2020-11-01"},1:{start:"2020-11-02",stop:"2020-11-08"},2:{start:"2020-11-09",stop:"2020-11-15"},3:{start:"2020-11-16",stop:"2020-11-22"},4:{start:"2020-11-23",stop:"2020-11-29"},5:{start:"2020-11-30",stop:"2020-12-06"},6:{start:"2020-12-07",stop:"2020-12-13"},7:{start:"2020-12-14",stop:"2020-12-20"},8:{start:"2021-01-04",stop:"2021-01-10"},9:{start:"2021-01-11",stop:"2021-01-17"},10:{start:"2021-01-18",stop:"2021-01-24"},11:{start:"2021-01-25",stop:"2021-01-31"},12:{start:"2021-02-01",stop:"2021-02-07"},13:{start:"2021-02-08",stop:"2021-02-14"},exam:{start:"2021-02-08",stop:"2021-02-20"}},3205:{0:{start:"2020-07-06",stop:"2020-07-12"},1:{start:"2020-07-13",stop:"2020-07-19"},2:{start:"2020-07-20",stop:"2020-08-26"},3:{start:"2020-07-27",stop:"2020-08-02"},4:{start:"2020-08-03",stop:"2020-08-16"},5:{start:"2020-08-17",stop:"2020-08-23"},6:{start:"2020-08-24",stop:"2020-08-30"},7:{start:"2020-08-31",stop:"2020-09-06"},8:{start:"2020-09-07",stop:"2020-09-13"},9:{start:"2020-09-14",stop:"2020-09-20"},10:{start:"2020-09-21",stop:"2020-09-27"},11:{start:"2020-09-28",stop:"2020-10-04"},12:{start:"2020-10-05",stop:"2020-10-11"},13:{start:"2020-10-12",stop:"2020-10-18"},14:{start:"2020-10-19",stop:"2020-10-25"},15:{start:"2020-10-27",stop:"2020-11-01"},exam:{start:"2020-10-12",stop:"2020-10-18"}},3201:{0:{start:"2020-02-17",stop:"2020-02-23"},1:{start:"2020-02-24",stop:"2020-03-01"},2:{start:"2020-03-02",stop:"2020-03-08"},3:{start:"2020-03-09",stop:"2020-03-15"},4:{start:"2020-03-16",stop:"2020-03-22"},5:{start:"2020-03-23",stop:"2020-03-29"},6:{start:"2020-03-30",stop:"2020-04-05"},7:{start:"2020-04-13",stop:"2020-04-19"},8:{start:"2020-04-20",stop:"2020-04-26"},9:{start:"2020-04-27",stop:"2020-05-03"},10:{start:"2020-05-04",stop:"2020-05-10"},11:{start:"2020-05-11",stop:"2020-05-17"},12:{start:"2020-05-18",stop:"2020-05-24"},13:{start:"2020-05-25",stop:"2020-05-31"},exam:{start:"2020-06-01",stop:"2020-06-07"}},3198:{0:{start:"2019-10-21",stop:"2019-10-27"},1:{start:"2019-10-28",stop:"2019-11-03"},2:{start:"2019-11-04",stop:"2019-11-10"},3:{start:"2019-11-11",stop:"2019-11-17"},4:{start:"2019-11-18",stop:"2019-11-24"},5:{start:"2019-11-25",stop:"2019-12-1"},6:{start:"2019-12-02",stop:"2019-12-08"},7:{start:"2019-12-09",stop:"2019-12-15"},8:{start:"2019-12-16",stop:"2019-12-22"},9:{start:"2020-01-06",stop:"2020-01-12"},10:{start:"2020-01-13",stop:"2020-01-19"},11:{start:"2020-01-20",stop:"2020-01-26"},12:{start:"2020-01-27",stop:"2020-02-02"},13:{start:"2020-02-03",stop:"2020-02-09"},exam:{start:"2020-02-06",stop:"2020-02-15"}},2197:{0:{start:"2019-11-18",stop:"2019-11-24"},1:{start:"2019-11-25",stop:"2019-12-01"},2:{start:"2019-12-02",stop:"2019-12-08"},3:{start:"2019-12-09",stop:"2019-12-15"},4:{start:"2019-12-16",stop:"2019-12-22"},5:{start:"2019-12-23",stop:"2019-09-29"},6:{start:"2019-12-30",stop:"2020-01-05"},7:{start:"2020-01-06",stop:"2020-01-12"},8:{start:"2020-01-13",stop:"2020-01-19"},9:{start:"2020-01-20",stop:"2020-01-26"},10:{start:"2020-01-27",stop:"2020-02-02"},11:{start:"2020-02-03",stop:"2020-02-09"},12:{start:"2020-02-10",stop:"2020-02-16"},13:{start:"2019-02-17",stop:"2020-02-23"},14:{start:"2020-02-24",stop:"2020-03-01"},15:{start:"2020-03-02",stop:"2020-03-08"}},2195:{0:{start:"2019-08-19",stop:"2019-09-25"},1:{start:"2019-08-26",stop:"2019-09-01"},2:{start:"2019-09-02",stop:"2019-09-18"},3:{start:"2019-09-09",stop:"2019-09-15"},4:{start:"2019-09-16",stop:"2019-09-22"},5:{start:"2019-09-23",stop:"2019-09-29"},6:{start:"2019-09-30",stop:"2019-10-06"},7:{start:"2019-10-07",stop:"2019-10-13"},8:{start:"2019-10-14",stop:"2019-08-20"},9:{start:"2019-10-21",stop:"2019-10-27"},10:{start:"2019-10-28",stop:"2019-11-03"},11:{start:"2019-11-04",stop:"2019-11-10"},12:{start:"2019-11-11",stop:"2019-11-17"},13:{start:"2019-11-18",stop:"2019-11-24"},14:{start:"2019-11-25",stop:"2019-12-01"},15:{start:"2019-10-07",stop:"2019-10-13"}},3195:{0:{start:"2019-07-01",stop:"2019-07-07"},1:{start:"2019-07-08",stop:"2019-07-14"},2:{start:"2019-07-15",stop:"2019-07-21"},3:{start:"2019-07-22",stop:"2019-07-28"},4:{start:"2019-07-29",stop:"2019-08-04"},5:{start:"2019-08-05",stop:"2019-08-11"},6:{start:"2019-08-19",stop:"2019-08-25"},7:{start:"2019-08-26",stop:"2019-09-01"},8:{start:"2019-09-02",stop:"2019-09-08"},9:{start:"2019-09-09",stop:"2019-09-15"},10:{start:"2019-09-16",stop:"2019-09-22"},11:{start:"2019-09-23",stop:"2019-09-29"},12:{start:"2019-09-30",stop:"2019-10-06"},13:{start:"2019-10-07",stop:"2019-10-13"},14:{start:"2019-10-14",stop:"2019-10-20"},15:{start:"2019-10-21",stop:"2019-10-27"},exam:{start:"2019-10-10",stop:"2019-10-19"}},3191:{0:{start:"2019-02-18",stop:"2019-02-24"},1:{start:"2019-02-25",stop:"2019-03-03"},2:{start:"2019-03-04",stop:"2019-03-10"},3:{start:"2019-03-11",stop:"2019-03-17"},4:{start:"2019-03-18",stop:"2019-03-24"},5:{start:"2019-03-25",stop:"2019-03-31"},6:{start:"2019-04-01",stop:"2019-04-07"},7:{start:"2019-04-08",stop:"2019-04-14"},8:{start:"2019-04-22",stop:"2019-04-28"},9:{start:"2019-04-29",stop:"2019-05-05"},10:{start:"2019-05-06",stop:"2019-05-12"},11:{start:"2019-05-13",stop:"2019-05-19"},12:{start:"2019-05-20",stop:"2019-05-26"},13:{start:"2019-05-27",stop:"2019-06-02"},14:{start:"2019-06-03",stop:"2019-06-09"},15:{start:"2019-06-10",stop:"2019-06-17"},exam:{start:"2019-05-30",stop:"2019-06-08"}}};class UniversityDateCalendar{constructor(){if(UniversityDateCalendar._instance)return UniversityDateCalendar._instance;UniversityDateCalendar._instance=this,this.defaultPeriod="3221"}getWeekDetails(week,period=this.defaultPeriod){return"string"==typeof week&&week.startsWith("Week")&&(week=parseInt(week.substring(4))),period in CALENDAR&&week in CALENDAR[period]?CALENDAR[period][week]:null}getDate(week,startWeek=!0,dayOfWeek="Monday"){let date={date:"",month:"",week:week,year:0};dayOfWeek=dayOfWeek.toLowerCase();let weekDetails=this.getWeekDetails(week);if(null===weekDetails)return date;let d=new Date(weekDetails.start);const dayToNum={tuesday:1,tue:1,wednesday:2,wed:2,thursday:3,thu:3,friday:4,fri:4,saturday:5,sat:5,sunday:6,sun:6};return"monday"!==dayOfWeek&&(date.day=dayOfWeek.charAt(0).toUpperCase()+dayOfWeek.substring(1,3),dayOfWeek in dayToNum&&d.setDate(d.getDate()+dayToNum[dayOfWeek.toLowerCase()])),date.month=MONTHS[d.getMonth()],date.date=d.getDate(),date.year=d.getFullYear(),date}getCurrentPeriod(){const titleElement=document.getElementById("courseMenu_link");if(null===titleElement)return this.defaultPeriod;let id,breakIdRe,m=titleElement.getAttribute("title").match(/^.*\((.+)\)/);if(m){if(id=m[1],breakIdRe=new RegExp("^([A-Z]+[0-9]+)_([0-9][0-9][0-9][0-9])_([A-Z][A-Z])$"),m=id.match(breakIdRe),m)return m[2];if(breakIdRe=new RegExp("^([0-9]+[A-Z]+)_([0-9][0-9][0-9][0-9])_([A-Z][A-Z])$"),m=id.match(breakIdRe),m)return m[1].includes("QCM")?m[2]+"QCM":m[2];if(breakIdRe=new RegExp("^([0-9]+[A-Z]+)_([0-9][0-9][0-9][0-9])$"),m=id.match(breakIdRe),m)return m[2];if(breakIdRe=new RegExp("^([0-9]+[A-Z]+)_(Y[0-9])_([0-9][0-9][0-9][0-9])_([A-Z][A-Z])$"),m=id.match(breakIdRe),m)return m[3]}return this.defaultPeriod}}window.CircularProgressBar=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){t.exports=function(){"use strict";const t=function(t,e){const n="number"==typeof t?{value:t}:t;Object.entries(n).map((([t,n])=>e(n,t)))};function e(t,e){this.start=new Date/1e3,this.time=e,this.from=t,this.current=t,this.to=t,this.speed=0}return e.prototype.get=function(t){const e=t/1e3-this.start;if(e<0)throw new Error("Cannot read in the past");return e>=this.time?this.to:this.to-((t,e,n,i)=>(e*n+2*t)/n**3*i**3+-(2*e*n+3*t)/n**2*i**2+e*i+t)(this.to-this.from,this.speed,this.time,e)},e.prototype.getSpeed=function(t){const e=t/1e3-this.start;return e>=this.time?0:((t,e,n,i)=>(e*n+2*t)/n**3*3*i**2+-(2*e*n+3*t)/n**2*2*i+e)(this.to-this.from,this.speed,this.time,e)},e.prototype.set=function(t,e){const n=new Date,i=this.get(n);return this.speed=this.getSpeed(n),this.start=n/1e3,this.from=i,this.to=t,e&&(this.time=e),i},function(n,i=300){return"number"==typeof n&&(n={value:n}),t(n,((t,r)=>{const o=new e(t,i/1e3);Object.defineProperty(n,"_"+r,{value:o}),Object.defineProperty(n,r,{get:()=>o.get(new Date),set:t=>o.set(t),enumerable:!0})})),Object.defineProperty(n,"get",{get:()=>function(t="value",e=new Date){return this["_"+t].get(e)}}),Object.defineProperty(n,"set",{get:()=>function(e,n=0){t(e,((t,e)=>{this["_"+e].set(t,n/1e3)}))}}),n}}()},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return f}));var i=n(0),r=n.n(i);n(2);const o=(t,e)=>{Object.keys(e).forEach((n=>t.style[n]=e[n]))},s=Symbol("_values"),a=Symbol("_interpolated"),c=Symbol("_text"),u=Symbol("_update"),l=Symbol("_lastUpdate"),h=Symbol("_animationFrame");class f{constructor(t=0,e){this.options={...f.defaultOptions,...e},this.node=document.createElement("div"),this.node.className="circular-progress-bar",o(this.node,{width:`${this.options.size}px`,height:`${this.options.size}px`});const n=document.createElement("div");n.className="circular-progress-bar_value";const i=(100-this.options.barsWidth)/100*this.options.size;o(n,{background:this.options.valueBackground,width:`${i}px`,height:`${i}px`,top:this.options.barsWidth/2+"%",left:this.options.barsWidth/2+"%"}),this.node.appendChild(n),this[c]=document.createElement("div"),this[c].className="circular-progress-bar_value_text",o(this[c],{lineHeight:`${i}px`,fontSize:i/3+"px"}),n.appendChild(this[c]);const s=Array.isArray(t)?t:[t];this[a]=r()(s),this[u]=this[u].bind(this),this.values=s}get value(){return this.values[0]}get values(){return this[s]}set value(t){this.values=[t]}set values(t){if(this[s]=t,t.length!==this[a].length){const e=new Date,n=this[a].map(((t,e)=>this[a][`_${e}`]));for(;n.length&&0===n[n.length-1].get(e);)n.length-=1;const{length:i}=n;this[a]=r()(new Array(Math.max(i,t.length)).fill(0));for(let t=0;t<i;++t){const i=n[t],r=this[a][`_${t}`];r.time=0,r.to=i.get(e)}t.push(...new Array(Math.max(0,i-t.length)).fill(0))}this[a].set(t,this.options.transitionTime),this[l]=performance.now(),this[h]=this[u](0);const e=this[s].reduce(((t,e)=>t+e),0);let n="";if(e>=this.options.max&&this.options.valueWhenDone)n=this.options.valueWhenDone;else{let t=this.values.length>1?e:this.values[0];"%"===this.options.valueUnit&&(t/=this.options.max/100),n=`${t.toFixed(this.options.valueDecimals)}${this.options.valueUnit}`}this.options.showValue&&(this[c].textContent=n)}appendTo(t){t.appendChild(this.node)}remove(){this.node.remove()}static get defaultOptions(){return{size:150,barsWidth:20,max:100,showValue:!0,valueDecimals:0,valueUnit:"%",valueBackground:"#333",colors:["#0484d1","#e53b44","#2ce8f4","#ffe762","#63c64d","#fb922b"],background:"rgba(0, 0, 0, .3)",transitionTime:500,valueWhenDone:null}}}f.prototype[u]=function(t){if(t>this[l]+this.options.transitionTime)return;this[h]&&cancelAnimationFrame(this[h]),this[h]=requestAnimationFrame(this[u]);let e=0;const n=this[a].map(((t,n)=>{const i=t/this.options.max*100;if(i<.1)return null;const r=`${o=this.options.colors,s=n,o[s%o.length]} ${e}% ${e+i}%`;var o,s;return e+=i+.1,r})).filter((t=>t));e<100&&n.push(`transparent ${e}% 100%`),this.node.style.background=`conic-gradient(${n.join(",")}) ${this.options.background}`}},function(t,e,n){var i=n(3),r=n(4);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var s=(i(r,{insert:"head",singleton:!1}),r.locals?r.locals:{});t.exports=s},function(t,e,n){"use strict";var i,o=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function a(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},i=[],r=0;r<t.length;r++){var o=t[r],c=e.base?o[0]+e.base:o[0],u=n[c]||0,l="".concat(c," ").concat(u);n[c]=u+1;var h=a(l),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(f)):s.push({identifier:l,updater:v(f,e),references:1}),i.push(l)}return i}function u(t){var e=document.createElement("style"),i=t.attributes||{};if(void 0===i.nonce){var r=n.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var l,h=(l=[],function(t,e){return l[t]=e,l.filter(Boolean).join("\n")});function f(t,e,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(t.styleSheet)t.styleSheet.cssText=h(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function p(t,e,n){var i=n.css,r=n.media,o=n.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var d=null,m=0;function v(t,e){var n,i,r;if(e.singleton){var o=m++;n=d||(d=u(e)),i=f.bind(null,n,o,!1),r=f.bind(null,n,o,!0)}else n=u(e),i=p.bind(null,n,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var i=0;i<n.length;i++){var r=a(n[i]);s[r].references--}for(var o=c(t,e),u=0;u<n.length;u++){var l=a(n[u]);0===s[l].references&&(s[l].updater(),s.splice(l,1))}n=o}}}},function(t,e,n){(e=n(5)(!1)).push([t.i,".circular-progress-bar {\n  display: inline-block;\n  border-radius: 50%;\n}\n.circular-progress-bar .circular-progress-bar_value {\n  position: relative;\n  display: inline-block;\n  border-radius: 50%;\n}\n.circular-progress-bar .circular-progress-bar_value .circular-progress-bar_value_text {\n  text-align: center;\n  font-family: monospace;\n  color: #fff;\n  mix-blend-mode: difference;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var s,a,c,n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),o=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[n].concat(o).concat([r]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<t.length;a++){var c=[].concat(t[a]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}}]).default;const DEFAULT_DATE_LABEL="Commencing";class GriffithCardsView extends cc_View{constructor(model,controller){super(model,controller),this.currentCollection=this.model.getCurrentCollection()}display(){DEBUG&&console.log("-------------- GriffithCardsView.display()");let div=document.getElementById("cc-canvas-collections");this.calendar=new UniversityDateCalendar;let message=document.createElement("div");message.className="cc-message",message.innerHTML="";document.body.insertAdjacentHTML("afterbegin",'<script src="https://unpkg.com/circular-progress-bar@2.1.0/public/circular-progress-bar.min.js"><\/script>');const cards=this.generateCards();div.insertAdjacentElement("beforeend",message),div.insertAdjacentElement("beforeend",cards),this.stopCardDescriptionPropagation(),this.makeCardsClickable()}generateCards(){DEBUG&&console.log("-------------- griffithCardsView.generateCards()");let cardCollection=document.createElement("div");cardCollection.id="cc-card-interface";cardCollection.innerHTML="\n\t\t<style>\n\t\t#cc-card-interface { \n\t\t\tmargin-top: 0.5em !important;\n\t\t\tflex-wrap: wrap;\n\t\t\tdisplay: flex;\n\t\t\tmargin: -0.75rem\n\t\t}\n\n\t\t.cc-clickable-card, .cc-coming-soon-card {\n\t\t\tpadding: 0.75rem;\n\t\t\tflex-direction: column;\n\t\t\tdisplay: flex;\n\t\t\twidth: 30%;\n\t\t}\n\n\t\t@media (max-width:640px) {\n\t\t\t.cc-clickable-card,  .cc-coming-soon-card {\n\t\t\t\twidth: 50%\n\t\t\t}\n\t\t}\n\n\t\t@media (max-width:480px)  \n\t\t    .cc-coming-soon-card, .cc-clickable-card {\n\t\t\t\twidth:100%;\n\t\t\t}\n\t\t}\n\n\t\t.cc-clickable-card:hover {\n\t\t\tcursor: pointer;\n\t\t\topacity: 0.8;\n\t\t}\n\n\t\t.cc-card {\n\t\t\tbox-shadow: 0 10px 15px -3px rgb(0 0 0/ 0.1), 0 4px 6px -4px rgb(0 0 0/ 0.1);\n\t\t\tbackground-color: #fff;\n/*\t\t\tborder: 1px solid #000; */\n\t\t\tborder-radius: 0.5rem;\n\t\t\toverflow: hidden;\n\t\t\tflex-direction: column;\n\t\t\tflex: 1 1 0%;\n\t\t\tdisplay: flex;\n\t\t\tposition:relative;\n\t\t}\n\n\t\t.cc-card:hover{\n\t\t\tbackground-color: #f5f5f5;\n\t\t\tbox-shadow: none;\n\t\t}\n\n\t\t.cc-card-image {\n\t\t\tbackground-repeat: no-repeat;\n\t\t\tbackground-position: center;\n\t\t\tbackground-size: cover;\n\t\t\theight: 10rem;\n\t\t\tborder-radius: 0.5rem 0.5rem 0 0;\n\t\t}\n\n\t\t.cc-card-content {\n\t\t\tpadding: 0.5rem;\n\t\t\tflex: 1 1 0%;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t}\n\n\t\t.cc-card-content:hover {\n\t\t\tcursor: pointer;\n\t\t}\n\n\t\t.cc-card-description {\n\t\t\tfont-size: 0.75rem;\n\t\t}\n\n\t    .cc-card-description a {\n\t\t\ttext-decoration: underline;\n\t\t\tflex: 1 1 0%;\n\t\t\tfont-size: 0.8em;\n\t\t\tmargin-bottom: 1rem;\n\t\t}\n\n\t\t.cc-progress {\n\t\t\tposition: absolute;\n\t\t\tbottom: 0;\n\t\t\tleft: 0;\n\t\t\tpadding: 0.5em;\n\t\t}\n\n\t\t.cc-card-title {\n\t\t\tfont-size: 1rem;\n\t\t\tfont-weight: bold;\n\t\t}\n\n\t\t.cc-card-label {\n\t\t\tfont-size: 0.9rem;\n\t\t\tmargin-bottom: 1rem;\n\t\t}\n\n\t\t.cc-card-engage {\n\t\t\tposition: absolute;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\tpadding: 1rem;\n\t\t}\n\n\t\t.cc-card-engage-button {\n\t\t\tpadding-top: 0.5rem;\n\t\t\tpadding-bottom: 0.5rem;\n\t\t\tpadding-left: 1rem;\n\t\t\tpadding-right: 1rem;\n\t\t\tcolor: rgba(30,58,138,1);\n\t\t\tborder-style: solid;\n\t\t\tborder-width: 1px;\n\t\t\tborder-radius: 0.25rem;\n\t\t\tborder-color: rgba(30,58,138,1);\n\t\t}\n\n\t\t.cc-card-engage-button:hover {\n\t\t\tbackground-color: rgba(30,58,138,1);\n\t\t\tcolor: white;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder: transparent;\n\t\t\tborder-radius: 0.25rem;\n\t\t}\n\n\t\t.cc-card-date {\n\t\t\ttext-align: center;\n\t\t\tbackground-color: #f5f5f5;\n\t\t\tborder-radius: 0.25rem;\n\t\t\toverflow: hidden;\n\t\t\twidth: 5rem;\n\t\t\tdisplay:block;\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tright: 0;\n\t\t}\n\n\t\t.cc-card-date-label { \n\t\t\tcolor: white;\n\t\t\tfont-size: 0.75rem;\n\t\t\tpadding-top: 0.25rem;\n\t\t\tpadding-bottom: 0.25rem;\n\t\t\tbackground-color: black;\n\t\t\tborder-color: black;\n\t\t\tborder-left-width: 1px;\n\t\t\tborder-right-width: 1px;\n\t\t\tborder-top-width: 1px;\n\t\t}\n\n\t\t.cc-card-date-week {\n\t\t\tcolor: black;\n\t\t\tbackground-color: #fff9c2;\n\t\t\tfont-size: 0.75rem;\n\t\t\tpadding-top: 0.15rem;\n\t\t}\n\n\t\t.cc-card-date-time {\n\t\t\tfont-size: 0.75rem;\n\t\t\tcolor: black;\n\t\t\tbackground-color: #fff382;\t\n\t\t\tpadding-top: 0.25rem;\n\t\t\tpadding-bottom: 0.25rem;\n\t\t}\n\n\t\t.cc-card-date-month {\n\t\t\tcolor: white;\n\t\t\tbackground-color: red;\n\t\t\tpadding-top: 0.25rem;\n\t\t\tpadding-bottom: 0.25rem;\n\t\t\tborder-color: black;\n\t\t\tborder-left-width: 1px;\n\t\t\tborder-right-width: 1px;\n\t\t\tborder-top-width: 1px;\n\t\t\tfont-size: 0.9rem;\n\t\t\tline-height: 1rem;\n\t\t}\n\n\t\t.cc-card-date-date {\n\t\t\tpadding-top: 0.25rem;\n\t\t\tpadding-bottom: 0.25rem;\n\t\t\tborder-left-width: 1px;\n\t\t\tborder-bottom-width: 1px;\n\t\t\tborder-right-width: 1px;\n\t\t\tborder-bottom-right-radius: 0.25rem;\n\t\t\tborder-bottom-left-radius: 0.25rem;\n\t\t\tborder-color: black;\n\t\t\tfont-size: 0.9rem;\n\t\t\tfont-weight: bold;\n\t\t\tline-height: 1rem;\n\t\t}\n\n\t\t.cc-progress {\n\t\t\tfloat: right;\n\t\t}\n\n\t\t.cc-card-published {\n\t\t\tbackground-color: red;\n\t\t\tcolor: white;\n\t\t\tfont-size: x-small;\n\t\t\tfont-weight: bold;\n\t\t\tpadding-top: 0.25rem;\n\t\t\tpadding-bottom: 0.25rem;\n\t\t\ttext-align: center;\n\t\t\twidth: 100%;\n\t\t}\n\n\t\t.cc-coming-soon-message {\n\t\t\tfont-size: 0.75rem;\n\t\t\tpadding: .5em;\n            background-color: #feee88;\n\t\t}\n\t\t</style>";for(let module of this.model.getModulesCollections()){if(DEBUG&&console.log(module),module.collection!==this.model.getCurrentCollection()){document.querySelector(`div.context_module[data-module-id="${module.id}"]`).style.display="none";continue}document.querySelector(`div.context_module[data-module-id="${module.id}"]`).style.display="block";const card=this.generateCard(module);cardCollection.insertAdjacentElement("beforeend",card)}return cardCollection=this.addComingSoonCards(cardCollection),cardCollection}addComingSoonCards(cardCollection){const collectionsModules=this.model.getCollectionsModules(this.currentCollection);if(!collectionsModules)return cardCollection;if(this.model.getModulesCollections().filter((module=>module.collection===this.model.getCurrentCollection())).length===collectionsModules.length)return cardCollection;const comingSoonModules=collectionsModules.filter((module=>module.comingSoon));for(let module of comingSoonModules){const card=this.generateCard(module,!1),order=module.comingSoon.order-1,cards=cardCollection.querySelectorAll(".cc-clickable-card");cardCollection.insertBefore(card,cards[order])}return cardCollection}generateCard(module,published=!0){const imageUrl=this.generateCardImageUrl(module),imageSize=this.generateCardImageSize(module),LINK_ITEM=this.generateCardLinkItem(module),PUBLISHED=this.generateCardPublished(module);let DATE_WIDGET="";module.date&&(module.date.week||module.date.month&&module.date.date)&&(DATE_WIDGET=this.generateCardDate(module.date));const description=module.description;let COMING_SOON=this.generateComingSoon(module);let CARD_LABEL="";module.label&&module.num&&(CARD_LABEL=`${module.label} ${module.num}`);const cardHtml=`\n    <div id="cc_module_${module.id}" class="cc-card">\n      <a href="#${module.id}" class="cc-card-link"></a>\n      <div class="cc-card-image" style="${imageSize} background-image: url('${imageUrl}')">\n\t    \n      </div>\n      ${DATE_WIDGET}\n      ${COMING_SOON}\n\t ${PUBLISHED}\n      <div class="cc-card-content">\n\t<div class=cc-card-label">\n\t    <span class="cc-card-label">\n\t\t${CARD_LABEL}\n\t    </span>\n\t    <h3 class="cc-card-title">${module.name}</h3>\n\t</div>\n      <div class="cc-card-description">\n\t  ${description}\n\t</div>\n\t<p></p>\n\t \n\t ${LINK_ITEM}\n\t \n\t \n\t  \n\t <div class="cc-progress"></div>\n      </div>\n    </div>\n    `;let wrapper=document.createElement("div");if(published)wrapper.classList.add("cc-clickable-card"),wrapper.innerHTML=cardHtml;else{wrapper.classList.add("cc-coming-soon-card"),wrapper.innerHTML=cardHtml,wrapper.querySelector(".cc-card-link").remove();const button=wrapper.querySelector(".cc-card-engage-button");button&&button.remove()}const progress=this.getCardProgressElement(module);if(progress){const progressDiv=wrapper.querySelector(".cc-progress");progressDiv&&progress.appendTo(progressDiv)}return wrapper}generateComingSoon(module){if(!module.comingSoon)return"";let date=this.convertUniDateToReal(module.comingSoon.date);return`\n\t\t<div class="cc-coming-soon-message">\n\t\t  <span>🚧</span>\n\t\t  <span>${`Available ${date.MONTH} ${date.DATE}`}</span>\n\t\t</div>\n\t\t`}generateCardDate(dateJson){const date={from:{},to:void 0};return date.from=this.convertUniDateToReal(dateJson),dateJson.endDate&&(date.to=this.convertUniDateToReal(dateJson.endDate),this.generateDualDate(date)),this.convertDateToHtml(date)}convertUniDateToReal(dateJson){let firstDate={};if(firstDate.DATE_LABEL=dateJson.label||"Commencing",firstDate.WEEK=dateJson.week||"",firstDate.DAY=dateJson.day||"",firstDate.TIME=dateJson.time||"",firstDate.MONTH=dateJson.month||"",firstDate.DATE=dateJson.date||"",""!==firstDate.WEEK){let actualDate={};actualDate=""===firstDate.DAY?this.calendar.getDate(firstDate.WEEK):this.calendar.getDate(firstDate.WEEK,!1,firstDate.DAY),firstDate.DATE=actualDate.date,firstDate.MONTH=actualDate.month}return""===firstDate.WEEK&&""===firstDate.TIME&&""===firstDate.MONTH&&""===firstDate.DATE?"":firstDate}convertDateToHtml(date){const singleDateHtml=`\n\t\t<div class="cc-card-date">\n\t\t  <div class="cc-card-date-label">\n             ${date.from.DATE_LABEL}\n          </div>\n\t\t  <div class="cc-card-date-week">\n          \t${date.from.DAY} Week ${date.from.WEEK}\n\t\t  </div>\n\t\t  <div class="cc-card-date-time">\n          ${date.from.TIME}\n\t\t  </div>\n\t\t  <div class="cc-card-date-month">\n      \t     ${date.from.MONTH}\n          </div>\n\t\t  <div class="cc-card-date-date">\n      \t     ${date.from.DATE}\n          </div>\n        </div>\n\t\t`;let element=(new DOMParser).parseFromString(singleDateHtml,"text/html").body.firstChild;return""===date.from.TIME&&element.removeChild(element.querySelector(".cc-card-date-time")),""===date.from.WEEK&&element.removeChild(element.querySelector(".cc-card-date-week")),element.outerHTML}generateDualDate(date){return'\n<div class="block rounded-t rounded-b overflow-hidden bg-white text-center w-24 absolute pin-t pin-r">\n          <div class="bg-black text-white py-1 text-xs border-l border-r border-black">\n             {DATE_LABEL}\n          </div>\n          {WEEK}\n          {DAYS}\n          {TIME}\n          <div class="bg-red text-white flex items-stretch py-1 border-l border-r border-black">\n              <div class="w-1/2 flex-grow">{MONTH_START}</div>\n              <div class="flex items-stretch border-l border-black flex-grow  -mt-1 -mb-1"></div>\n              <div class="w-1/2">{MONTH_STOP}</div>\n          </div>\n          <div class="border-l border-r border-b text-center flex border-black items-stretch pt-1">\n      \t     <div class="w-1/2 text-2xl flex-grow font-bold">{DATE_START}</div>\n      \t     <div class="flex font-bolditems-stretch border-l border-black flex-grow -mt-1"></div>\n              <div class="w-1/2 text-2xl font-bold">{DATE_STOP}</div>\n          </div>\n         </div> \n'}generateCardCompletion(module){DEBUG&&console.log("----------- griffithCardsView.generateCardCompletion()");const colour={Completed:"bg-green-500","In Progress":"bg-yellow-500",Locked:"bg-red-500"};if(void 0===module.cc_itemsCompleted)return"";let completionStatus="In Progress";if(module.cc_itemsCompleted.numCompleted===module.cc_itemsCompleted.numRequired&&(completionStatus="Completed"),!(completionStatus in colour))return"";const length=completionStatus.length;return`\n      <div  class="${colour[completionStatus]} text-xs rounded-full py-1 text-center font-bold"\n\t    style="width:${length}em" >\n\t<div class="">${completionStatus}</div>\n      </div>\n\t    `}getCardProgressElement(module){if(void 0===module.cc_itemsCompleted)return;const percentComplete=100*module.cc_itemsCompleted.numCompleted/module.cc_itemsCompleted.numRequired;let valueBackground="#ccc";percentComplete>=100?valueBackground="rgb(16,185,129)":percentComplete<50&&(valueBackground="rgb(245,158,11)");return new CircularProgressBar(percentComplete,{size:50,background:"#eee",valueBackground:valueBackground,colors:["#0484d1","#e53b44","#2ce8f4","#ffe762","#63c64d","#fb922b"]})}generateCardImageUrl(module){let imageUrl="https://www.signfix.com.au/wp-content/uploads/2017/09/placeholder-600x400.png";return"image"in module&&(imageUrl=module.image),imageUrl}generateCardEngage(module){let engage="Engage";return"engage"in module&&(engage=module.engage),engage}generateCardImageSize(module){let imageSize="";return"imageSize"in module&&""!==module.imageSize&&"bg-contain"===module.imageSize&&(imageSize="background-size: contain !important; background-repeat: no-repeat; background-position: center;"),imageSize}generateCardLinkItem(module){const engage=this.generateCardEngage(module);let LINK_ITEM=`\n\t    <p>&nbsp;<br /> &nbsp;</p>\n\t  \x3c!--  <div class="p-4 absolute pin-r pin-b" style="right:0;bottom:0"> --\x3e\n\t\t<div class="cc-card-engage">\n\t       <a href="#${module.id}" class="gu-engage">\n\x3c!--\t\t     <div class="hover:bg-blue-300 hover:text-white hover:no-underline text-blue-900 font-semibold hover:text-white py-2 px-4 border border-blue-900 hover:border-transparent rounded"> --\x3e\n\t\t\t <div class="cc-card-engage-button">\n\t\t\t   ${engage}\n\t         </div></a>\n\t    </div>\n\t    `;return"noEngage"in module&&module.noEngage&&(LINK_ITEM="\n            "),LINK_ITEM}generateCardPublished(module){if(module.published||void 0===module.published)return"";return'\n    <span class="cc-card-published">\n\t    Unpublished\n    </span>\n\t    '}stopCardDescriptionPropagation(){let links=document.querySelectorAll(".carddescription a:not(.gu-engage)");for(let i=0;i<links.length;i++)links[i].addEventListener("click",(function(e){e.stopPropagation()}))}makeCardsClickable(){let cards=document.getElementsByClassName("cc-clickable-card");for(let i=0;i<cards.length;i++){cards[i].addEventListener("click",(function(event){let link=this.querySelector(".cc-card-link");null!==link&&link.click()}))}}}const VIEWS={CardsView:CardsView,TableView:TableView,CollectionOnlyView:CollectionOnlyView,GriffithCardsView:GriffithCardsView};class CollectionsViewFactory{static createView(viewType,model,controller){"View"!==viewType.endsWith(-4)&&(viewType+="View");const viewCreator=VIEWS[viewType];return viewCreator?new viewCreator(model,controller):null}}class CollectionsView extends cc_View{constructor(model,controller){super(model,controller),this.navView=new NavView(model,controller);model.getCurrentCollectionRepresentation();const collections=model.getCollections();this.representations={};for(let collection of collections){const representation=model.getCollectionRepresentation(collection);this.representations[collection]=CollectionsViewFactory.createView(representation,model,controller)}}display(){DEBUG&&console.log("-------------- cc_CollectionsView.display()"),this.removeCanvasCollectionsDiv(),this.addCanvasCollectionsDiv(),this.navView.display(),this.representations[this.model.getCurrentCollection()].display()}addCanvasCollectionsDiv(){let ccCanvasCollections=document.createElement("div");ccCanvasCollections.id="cc-canvas-collections";let canvasContent=document.getElementById("context_modules");canvasContent.insertBefore(ccCanvasCollections,canvasContent.firstChild)}removeCanvasCollectionsDiv(){let canvasCollections=document.getElementById("cc-canvas-collections");canvasCollections&&canvasCollections.parentNode.removeChild(canvasCollections)}}class cc_CollectionsController{constructor(controller){DEBUG&&console.log("-------------- cc_CollectionsController.constructor()"),this.parentController=controller,this.model=new CollectionsModel(this),this.view=new CollectionsView(this.model,this),this.view.display()}navigateCollections(event){DEBUG&&console.log("-------------- cc_CollectionsController.navigateCollections()"),DEBUG&&console.log(event),DEBUG&&console.log(`currentCollection: ${this.model.getCurrentCollection()}`),DEBUG&&console.log(`event innerText ${event.target.innerText}`);let newCollection=event.target.innerText;newCollection=newCollection.trim(),newCollection!==this.model.getCurrentCollection()&&(this.model.setCurrentCollection(newCollection),this.view.display())}}const DEBUG=!0;class cc_Controller{constructor(){DEBUG&&console.log("-------------- cc_Controller.constructor()"),this.setContext(),DEBUG&&console.log(`cc_Controller: location = ${location}`),DEBUG&&console.log(`cc_Controller: courseId = ${this.courseId}`),DEBUG&&console.log(`cc_Controller: modulesPage = ${this.modulesPage}`),DEBUG&&console.log(`cc_Controller: homeModulesPage = ${this.homeModulesPage}`),DEBUG&&console.log(`cc_Controller: editMode = ${this.editMode}`),DEBUG&&console.log(`cc_Controller: ccOn = ${this.ccOn}`),this.configFileDetails=null,this.cc_configuration=null,(this.modulesPage||this.homeModulesPage)&&(this.setCsrfToken(),DEBUG&&console.log(`cc_Controller: csrf = ${this.csrf}`),this.requestConfigFileId())}requestConfigFileId(){let callUrl=`/api/v1/courses/${this.courseId}/files?`+new URLSearchParams({search_term:"cc_config.json"});DEBUG&&console.log(`cc_Controller: requestConfig: callUrl = ${callUrl}`),fetch(callUrl,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-Token":this.csrfToken}}).then(this.status).then((response=>response.json())).then((json=>{DEBUG&&console.log(`cc_Controller: requestConfig: json = ${JSON.stringify(json)}`),0===json.length?DEBUG&&console.log("cc_Controller: requestConfig: no config file found"):1===json.length?(this.configFileDetails=json[0],this.requestConfigFileContent()):DEBUG&&console.log(`cc_Controller: requestConfig: more than one (${json.length}) config file found`)})).catch((error=>{console.log("cc_Controller: requestConfig: error = "),console.log(error)}),!1)}requestConfigFileContent(){if(DEBUG&&console.log(`cc_Controller: requestConfigFileContent: for ${this.configFileDetails.id}`),"application/json"!==this.configFileDetails["content-type"])return void(DEBUG&&console.log("cc_Controller: requestConfigFile: not json"));let callUrl=this.configFileDetails.url;DEBUG&&console.log(`cc_Controller: requestConfigFileContent: callUrl = ${callUrl}`),fetch(callUrl,{method:"GET"}).then(this.status).then((response=>response.json())).then((json=>{DEBUG&&console.log(`cc_Controller: requestConfigFileContent: json = ${JSON.stringify(json)}`),this.cc_configuration=json,this.ccOn="on"===this.cc_configuration.STATUS,this.requestModuleInformation()})).catch((error=>{console.log(`cc_Controller: requestConfigFileContent: error = ${error}`)}),!1)}requestModuleInformation(){DEBUG&&console.log(`cc_Controller: requestModuleInformation: for ${this.courseId}`);let callUrl=`/api/v1/courses/${this.courseId}/modules?include=items&per_page=500`;DEBUG&&console.log(`cc_Controller: requestModuleInformation: callUrl = ${callUrl}`),fetch(callUrl,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-Token":this.csrfToken}}).then(this.status).then((response=>response.json())).then((json=>{DEBUG&&console.log(`cc_Controller: requestModuleInformation: json = ${JSON.stringify(json)}`),this.moduleDetails=json,this.execute()})).catch((error=>{console.log("cc_Controller: requestModuleInformation: error = "),console.log(error)}),!1)}execute(){if(this.modulesPage||this.homeModulesPage)if(DEBUG&&console.log("-------------- cc_Controller.execute()"),console.log(this.cc_configuration),this.editMode){const configShowSwitch=document.getElementById("configShowSwitch");configShowSwitch&&(configShowSwitch.style.display="inline-block"),null===this.cc_configuration?(DEBUG&&console.log("-------------- cc_Controller.execute() Edit Mode - no config"),this.showConfiguration()):(DEBUG&&console.log("-------------- cc_Controller.execute() Edit Mode - config"),this.showConfiguration(),this.ccOn&&this.showCollections())}else null!==this.cc_configuration&&(DEBUG&&console.log("-------------- cc_Controller.execute() Students Mode - config"),this.ccOn&&this.showCollections());else DEBUG&&console.log('-------------- cc_Controller.execute() ERROR SHOULDN"T BE RUNNING')}turnOff(){let cc_canvas_collection=document.getElementById("cc-canvas-collections");cc_canvas_collection&&cc_canvas_collection.parentNode.removeChild(cc_canvas_collection),document.querySelectorAll("div.cc-module-config").forEach((moduleConfig=>{moduleConfig.remove()}));let cc_config_wrapper=document.getElementById("cc-config-wrapper");if(cc_config_wrapper){cc_config_wrapper.remove();let cc_switch_container=document.querySelector("div.cc-switch-container");cc_switch_container&&(cc_switch_container.style.borderBottom="1px solid #c7cdd1")}const configShowSwitch=document.getElementById("configShowSwitch");configShowSwitch&&(configShowSwitch.style.display="none")}showConfiguration(){DEBUG&&console.log("-------------- cc_Controller.showConfiguration()"),this.configurationController=new cc_ConfigurationController(this)}showCollections(){DEBUG&&console.log("-------------- cc_Controller.showCollectionsStudentMode()"),this.collectionsController=new cc_CollectionsController(this)}checkQueryString(){}setContext(){window.location.href;this.documentUrl=window.location.href,this.documentUrl=this.documentUrl.replace(/#$/,"");let courseId=ENV.COURSE_ID||ENV.course_id;if(!courseId){let urlPartIncludingCourseId=this.documentUrl.split("courses/")[1];urlPartIncludingCourseId&&(courseId=urlPartIncludingCourseId.split("/")[0])}this.courseId=courseId;let regEx=new RegExp(`courses/${courseId}/modules(#*|#[^/]+)$`);this.modulesPage=regEx.test(this.documentUrl),regEx=new RegExp(`courses/${courseId}$`),this.homeModulesPage=regEx.test(this.documentUrl)&&null!==document.getElementById("context_modules"),this.editMode=null!==document.getElementById("easy_student_view"),this.ccOn=!1}setCsrfToken(){let csrfRegex=new RegExp("^_csrf_token=(.*)$"),cookies=document.cookie.split(";");for(let i=0;i<cookies.length;i++){let cookie=cookies[i].trim(),match=csrfRegex.exec(cookie);if(match){this.csrf=decodeURIComponent(match[1]);break}}}saveConfig(){}}let controller=new cc_Controller;